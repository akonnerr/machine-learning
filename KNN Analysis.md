

```python
from numpy import *
import operator
```

# read


```python
fr = open('/Users/zhangshize/Github/machinelearninginaction/Ch02/datingTestSet2.txt')
```


```python
fr
```




    <open file '/Users/zhangshize/Github/machinelearninginaction/Ch02/datingTestSet2.txt', mode 'r' at 0x1093f30c0>




```python
arrayoflines = fr.readlines()
#读取每一行
```


```python
numberoflines = len(arrayoflines)
numberoflines
```




    1000




```python
returnMat = zeros((numberoflines,3))
returnMat
#这里不难看出就zero函数就是zero（（行，列））
```




    array([[0., 0., 0.],
           [0., 0., 0.],
           [0., 0., 0.],
           ...,
           [0., 0., 0.],
           [0., 0., 0.],
           [0., 0., 0.]])




```python
def file2matrix(filename):
    fr = open(filename)
    arrayoflines = fr.readlines()
    numberoflines = len(arrayoflines)
    returnMat = zeros((numberoflines,3))
    classlabelvector = []
    index = 0
    for line in arrayoflines:
        line = line.strip()
        listfromline = line.split('\t')
        returnMat[index,:] = listfromline[0:3]
        classlabelvector.append(int(listfromline[-1]))
        index += 1
    return returnMat,classlabelvector
#事实上这里的returnmat就是参数，classlabelvector就是标签，这也是处理一般文本格式的通用方法
```


```python
datingdatamat,datinglabels = file2matrix('/Users/zhangshize/Github/machinelearninginaction/Ch02/datingTestSet2.txt')
```

# norm


```python
datingdatamat
```




    array([[4.0920000e+04, 8.3269760e+00, 9.5395200e-01],
           [1.4488000e+04, 7.1534690e+00, 1.6739040e+00],
           [2.6052000e+04, 1.4418710e+00, 8.0512400e-01],
           ...,
           [2.6575000e+04, 1.0650102e+01, 8.6662700e-01],
           [4.8111000e+04, 9.1345280e+00, 7.2804500e-01],
           [4.3757000e+04, 7.8826010e+00, 1.3324460e+00]])




```python
minvals = datingdatamat.min(0)
minvals
```




    array([0.      , 0.      , 0.001156])




```python
maxvals = datingdatamat.max(0)
maxvals
```




    array([9.1273000e+04, 2.0919349e+01, 1.6955170e+00])




```python
ranges = maxvals - minvals
ranges
```




    array([9.1273000e+04, 2.0919349e+01, 1.6943610e+00])




```python
normdataset1 = zeros(shape(datingdatamat))
normdataset1
```




    array([[0., 0., 0.],
           [0., 0., 0.],
           [0., 0., 0.],
           ...,
           [0., 0., 0.],
           [0., 0., 0.],
           [0., 0., 0.]])




```python
m = normdataset.shape[0]
m
```




    1000




```python
c = tile(minvals,(m,1))
c
```




    array([[0.      , 0.      , 0.001156],
           [0.      , 0.      , 0.001156],
           [0.      , 0.      , 0.001156],
           ...,
           [0.      , 0.      , 0.001156],
           [0.      , 0.      , 0.001156],
           [0.      , 0.      , 0.001156]])




```python
normdataset3 = datingdatamat - tile(minvals,(m,1))
normdataset3
```




    array([[4.0920000e+04, 8.3269760e+00, 9.5279600e-01],
           [1.4488000e+04, 7.1534690e+00, 1.6727480e+00],
           [2.6052000e+04, 1.4418710e+00, 8.0396800e-01],
           ...,
           [2.6575000e+04, 1.0650102e+01, 8.6547100e-01],
           [4.8111000e+04, 9.1345280e+00, 7.2688900e-01],
           [4.3757000e+04, 7.8826010e+00, 1.3312900e+00]])




```python
d = tile(ranges,(m,1))
d
```




    array([[9.1273000e+04, 2.0919349e+01, 1.6943610e+00],
           [9.1273000e+04, 2.0919349e+01, 1.6943610e+00],
           [9.1273000e+04, 2.0919349e+01, 1.6943610e+00],
           ...,
           [9.1273000e+04, 2.0919349e+01, 1.6943610e+00],
           [9.1273000e+04, 2.0919349e+01, 1.6943610e+00],
           [9.1273000e+04, 2.0919349e+01, 1.6943610e+00]])




```python
normdataset4 = normdataset3/tile(ranges,(m,1))
normdataset4
```




    array([[0.44832535, 0.39805139, 0.56233353],
           [0.15873259, 0.34195467, 0.98724416],
           [0.28542943, 0.06892523, 0.47449629],
           ...,
           [0.29115949, 0.50910294, 0.51079493],
           [0.52711097, 0.43665451, 0.4290048 ],
           [0.47940793, 0.3768091 , 0.78571804]])



# test


```python
datingdatamat ,datinglabels = file2matrix('/Users/zhangshize/Github/machinelearninginaction/Ch02/datingTestSet2.txt')
```


```python
def autonorm(dataSet):
    minvals = dataSet.min(0)
    #列中取出最小值
    maxvals = dataSet.max(0)
    ranges = maxvals - minvals
    normdataset = zeros(shape(dataSet))
    m = dataSet.shape[0]
    normdataset = dataSet - tile(minvals,(m,1))
    normdataset = normdataset/tile(ranges,(m,1))
    return normdataset,ranges,minvals
```


```python
normmat,ranges,minvals = autonorm(datingdatamat)
```


```python
m = normmat.shape[0]
m
```




    1000




```python
horatio = 0.10
```


```python
numtestvect = int (m*horatio)
numtestvect
```




    100




```python
errorcount = 0.0
```


```python
e = normmat[1,:]
e
#e相当于测试集0-99
```




    array([0.15873259, 0.34195467, 0.98724416])




```python
f = normmat
f
```




    array([[0.44832535, 0.39805139, 0.56233353],
           [0.15873259, 0.34195467, 0.98724416],
           [0.28542943, 0.06892523, 0.47449629],
           ...,
           [0.29115949, 0.50910294, 0.51079493],
           [0.52711097, 0.43665451, 0.4290048 ],
           [0.47940793, 0.3768091 , 0.78571804]])




```python
g = normmat[numtestvect:m,:]
g
#g相当于训练集100-1000
```




    array([[0.46457331, 0.53983597, 0.12206372],
           [0.36871802, 0.31502142, 0.79791792],
           [0.10047878, 0.2252441 , 0.11391374],
           ...,
           [0.29115949, 0.50910294, 0.51079493],
           [0.52711097, 0.43665451, 0.4290048 ],
           [0.47940793, 0.3768091 , 0.78571804]])




```python
h = datinglabels[numtestvect:m]
#h训练集label
```

# knn classify


```python
def datingclasstest():
    horatio = 0.10
    datingdatamat ,datinglabels = file2matrix('/Users/zhangshize/Github/machinelearninginaction/Ch02/datingTestSet.txt')
    normmat,ranges,minvals = autonorm(datingdatamat)
    m = normmat.shape[0]
    numtestvect = int (m*horatio)
    errorcount = 0.0
    for i in range (numtestvect):
        classifierresult = classify0(normmat[i,:], normmat[numtestvect:m,:],datinglabels[numtestvect:m],3)
        print(("the classifier came back with :%d,the real answer is :%d") % (classifierresult,datinglabels[i]))
        # 这里需要注意文章中的两个数据集使不同的，一个label是int（%d），一个是str
        if (classifierresult != datinglabels[i]): errorcount += 1.0
    print(("the total error rate is :%f") % (errorcount/float(numtestvect)))
```


```python
dataSetSize = g.shape[0]
dataSetSize
```




    900




```python
diffMat = tile(e,(dataSetSize,1)) - g
diffMat
```




    array([[-0.30584072, -0.1978813 ,  0.86518044],
           [-0.20998543,  0.02693325,  0.18932624],
           [ 0.05825381,  0.11671056,  0.87333042],
           ...,
           [-0.1324269 , -0.16714827,  0.47644923],
           [-0.36837838, -0.09469984,  0.55823936],
           [-0.32067534, -0.03485443,  0.20152612]])




```python
sqDiffMat = diffMat**2
sqDiffMat
```




    array([[9.35385458e-02, 3.91570094e-02, 7.48537198e-01],
           [4.40938801e-02, 7.25399810e-04, 3.58444257e-02],
           [3.39350638e-03, 1.36213555e-02, 7.62706019e-01],
           ...,
           [1.75368826e-02, 2.79385442e-02, 2.27003872e-01],
           [1.35702632e-01, 8.96805967e-03, 3.11631183e-01],
           [1.02832672e-01, 1.21483134e-03, 4.06127775e-02]])




```python
sqDistances = sqDiffMat.sum(axis=1)
sqDistances
```




    array([0.88123275, 0.08066371, 0.77972088, 0.13980539, 0.53320823,
           0.45161012, 0.79973969, 0.07580057, 0.70822689, 0.9715694 ,
           0.10809284, 0.25373272, 0.38635396, 0.4153263 , 1.09714941,
           0.19964106, 0.60241715, 0.78079984, 0.07236318, 0.57544723,
           0.17680154, 0.11795841, 0.98936223, 1.01908911, 1.01893695,
           0.09443052, 0.19267153, 0.18623764, 0.89785076, 0.97576078,
           0.46991084, 0.56669575, 0.15991555, 0.05003127, 0.10979925,
           0.53625392, 0.07040596, 0.11547103, 1.14848897, 0.47627666,
           0.50212339, 0.35665757, 0.51172135, 0.16847027, 0.0760699 ,
           0.17120828, 0.23147619, 0.72103945, 0.97314182, 0.20903327,
           0.18568618, 0.71182203, 0.17572898, 0.1813059 , 0.38609647,
           0.35624579, 0.90090945, 0.47359823, 0.71258614, 1.25460287,
           0.29398765, 0.45443964, 0.05803121, 0.13853695, 1.03868037,
           0.73149638, 1.0409681 , 0.28844403, 0.22200924, 0.40896766,
           1.00206768, 0.4398473 , 0.61716377, 0.25004713, 0.20486818,
           0.03285226, 0.44067013, 0.16758835, 0.4035654 , 0.68702706,
           0.26941398, 0.13061899, 0.12797866, 0.66488652, 0.18652597,
           0.05232261, 0.01028626, 0.68140193, 0.1577711 , 0.03013253,
           0.13021004, 0.19347596, 0.34756977, 0.33890149, 0.02191018,
           0.35014598, 0.83094918, 1.00007188, 0.80905616, 0.6366309 ,
           0.03862316, 0.10401094, 0.18623244, 0.95416033, 0.28847094,
           0.08211008, 0.23540817, 0.16207152, 0.60174331, 0.99741826,
           0.42529352, 1.02912393, 0.1651709 , 0.68564389, 0.5768484 ,
           0.08893704, 1.04490794, 0.1336865 , 0.07838419, 0.76644302,
           0.84416914, 1.01918166, 0.8651383 , 0.99128469, 0.38021157,
           0.89853813, 0.82707078, 0.31045783, 1.0680294 , 0.70464951,
           0.54043462, 0.16887406, 0.57334997, 0.78149263, 0.6088467 ,
           0.83004387, 0.04611201, 0.54571996, 0.89018686, 0.80657746,
           0.63388379, 0.14034948, 0.72238288, 0.44588909, 0.29005631,
           0.00656091, 1.28544031, 0.11222472, 0.43538573, 0.33092102,
           0.89983296, 0.96681592, 0.95018177, 0.20159096, 0.05845498,
           0.49153915, 0.14270516, 0.69694336, 1.18362293, 0.79548199,
           0.26009714, 0.85797072, 0.8604025 , 0.6640539 , 0.57277541,
           0.06225624, 0.1393795 , 0.2319966 , 0.11430733, 0.25498829,
           0.23032487, 0.72193049, 0.27608601, 0.71935422, 0.94116936,
           0.3176085 , 0.33962672, 0.59475313, 0.25143718, 1.10144851,
           0.45143535, 0.42211231, 0.95972922, 0.20537086, 0.14705303,
           0.20382804, 0.45668063, 0.6173747 , 0.07478309, 0.10405211,
           0.28050341, 1.02918812, 0.08501134, 0.15173253, 0.5196158 ,
           0.47039112, 0.23088694, 0.59863794, 0.50867336, 0.3705794 ,
           0.02753985, 0.46813773, 0.11849833, 0.47402523, 0.23181357,
           0.47157199, 0.08473332, 0.09224076, 0.25887315, 0.43377694,
           0.56456683, 0.51687273, 0.11044561, 0.33163929, 1.41516479,
           0.64468781, 0.51060005, 0.9338493 , 0.21469081, 0.58925825,
           0.40478384, 0.28634466, 0.40222155, 0.35218908, 0.05463431,
           0.46536334, 0.07713846, 0.49967354, 0.45304754, 0.05664893,
           0.48279568, 1.11762078, 0.95502585, 0.16285513, 0.29976196,
           0.54382768, 1.17833879, 1.02313235, 0.71361256, 0.19064122,
           0.76673683, 0.13634955, 1.25399347, 0.67791725, 1.04674448,
           0.59750006, 0.6101118 , 0.30063833, 0.6510723 , 0.83314266,
           0.89380338, 0.62110447, 0.00896607, 0.15280991, 1.09396645,
           0.42077546, 1.30275304, 0.17644031, 0.04366964, 0.91794481,
           1.50981699, 0.33074573, 0.24982204, 0.90080454, 0.80057983,
           0.58492733, 0.49760073, 0.75800225, 0.49076392, 0.13042343,
           0.72877996, 0.02031801, 0.59095073, 0.12073562, 0.45213205,
           0.75464928, 0.42068182, 0.33216988, 0.40828506, 0.48742219,
           1.27223166, 0.91876942, 0.99602013, 0.62945891, 0.17118183,
           0.43699102, 0.84601854, 0.14040059, 0.563917  , 0.8709982 ,
           0.36423661, 1.13675663, 0.26080424, 0.13728931, 0.3352335 ,
           0.14876424, 0.69814039, 1.10658411, 1.28694964, 0.30901873,
           0.41582449, 0.29846196, 0.69066866, 0.14355206, 0.35887673,
           0.1928243 , 0.19229939, 0.92997364, 0.35369967, 0.76039657,
           0.18139686, 0.21264852, 0.30069474, 1.01835376, 0.19988509,
           0.21604908, 0.77760114, 0.33746311, 0.49774758, 0.82344908,
           0.27702304, 0.14239318, 0.12230318, 0.47108767, 0.04235577,
           0.4444244 , 0.6192336 , 0.46649048, 0.192575  , 0.43929554,
           0.1880516 , 0.52244495, 0.85067448, 0.27737188, 0.70779653,
           0.50458952, 0.24325959, 0.47336372, 1.09445207, 0.222478  ,
           0.98673943, 0.14652041, 0.61067836, 0.27747482, 0.73438087,
           0.53631746, 0.16177284, 0.0976968 , 0.51996772, 0.20159662,
           0.24291653, 0.14508828, 0.22498592, 0.47753847, 0.60384726,
           0.08430076, 0.48721951, 0.23244381, 0.75728663, 0.43862548,
           0.14216578, 0.61362409, 0.81711194, 0.47054609, 0.15210772,
           1.0053388 , 0.64794178, 0.08950045, 0.39967932, 0.18771567,
           0.33941541, 0.51920617, 0.51423116, 0.3945804 , 0.38571642,
           0.63092396, 0.43837131, 0.95777337, 0.0514069 , 0.15988809,
           0.82554974, 0.82838095, 0.38982276, 0.60301375, 0.02351521,
           0.58527228, 0.2582487 , 1.00707067, 0.53920946, 0.81830862,
           0.24980686, 0.37770828, 0.8462517 , 0.25672827, 0.63969856,
           0.09132938, 0.54794551, 0.83096135, 0.2786817 , 0.00822637,
           0.45210701, 0.4464082 , 0.47428989, 0.06672171, 0.69044932,
           0.70549362, 0.96285371, 0.89395075, 1.29625673, 0.80467402,
           0.15702437, 0.85225575, 0.4151585 , 0.58493132, 0.02228459,
           0.06751419, 0.21616385, 0.21962916, 0.30570309, 0.30484363,
           0.0532189 , 0.27545956, 1.0381574 , 0.59261349, 0.0524002 ,
           0.85868779, 0.60715065, 0.53469793, 0.95691328, 0.24635732,
           0.7567361 , 0.97551067, 0.614957  , 0.48134797, 0.15398285,
           0.12110491, 0.08236183, 1.06147186, 0.39586553, 0.87287299,
           0.12548849, 0.22732022, 0.09035839, 0.16204889, 0.72433662,
           0.38931918, 0.4893233 , 0.26830107, 0.51077999, 0.3401178 ,
           0.26113263, 0.27709226, 0.07880082, 0.22668095, 0.07006818,
           0.73272155, 0.31490111, 0.94939755, 0.18473471, 0.23210738,
           0.17050942, 0.90635598, 0.53436744, 0.90331098, 0.21777864,
           0.95310109, 0.42172418, 0.8343508 , 0.13994983, 0.16478599,
           0.18153769, 0.77819517, 0.04738938, 1.06211344, 0.19617347,
           0.80534228, 0.16304375, 0.60223678, 0.05212663, 0.09605603,
           0.7692623 , 0.86201668, 0.86179019, 0.32085596, 0.18290143,
           0.31114299, 0.28729638, 1.07789772, 0.46124151, 0.62267883,
           0.74542783, 0.93582756, 1.0496676 , 0.00492794, 0.66795105,
           0.93640901, 0.38558659, 1.03362714, 0.1270103 , 0.91380071,
           0.05703121, 0.73893351, 0.47212508, 1.0363977 , 0.78924639,
           0.31644627, 0.91378518, 1.2825465 , 0.12510533, 0.38707454,
           0.52508681, 0.57692768, 0.56548721, 0.80120579, 0.13889916,
           0.10354518, 0.39688206, 0.72087478, 0.65573243, 0.37124314,
           0.10379465, 0.15990157, 0.76693652, 0.0162966 , 0.86598462,
           0.48685384, 0.39344607, 0.10062733, 0.12597005, 0.32904129,
           0.16890146, 0.54725644, 0.10867228, 0.18430392, 0.01334663,
           0.38808328, 0.94604225, 0.33364246, 0.54132394, 0.89198495,
           0.07265634, 0.94223634, 0.21296867, 0.14940688, 0.57634194,
           0.6900296 , 0.85081612, 0.37710429, 0.12982891, 0.54188193,
           0.06837867, 0.02403167, 0.89533534, 0.09300469, 1.04601949,
           0.13265782, 0.22520695, 0.30085924, 0.04106271, 0.52068842,
           0.64590262, 0.11889272, 0.47369912, 0.1539821 , 1.01296114,
           0.02633728, 0.21846701, 0.62116668, 0.70907127, 0.77539392,
           0.23138636, 0.35678135, 0.82511635, 0.17342277, 0.07263785,
           0.06601573, 0.59002121, 0.1341466 , 0.44167364, 0.99649205,
           0.24816591, 0.65941979, 1.0224855 , 0.12392351, 0.32044606,
           0.09398948, 0.46429198, 0.38713365, 0.12681024, 0.10231878,
           0.06447703, 0.42213321, 0.20226757, 1.07762292, 0.05858284,
           0.12421826, 0.01197016, 0.60234734, 0.66566995, 1.07215595,
           0.96381208, 0.35237017, 0.74571564, 0.36027616, 0.13377356,
           0.98305397, 0.47344274, 0.13726576, 0.39375945, 0.83413878,
           0.09996971, 0.19421454, 0.85774524, 0.86896744, 1.26887071,
           0.82808087, 0.47396328, 0.19356329, 0.46587787, 0.23013853,
           0.07015249, 0.2377254 , 0.75633605, 0.25446552, 0.12001752,
           0.14235772, 1.21785722, 0.12236097, 0.25443232, 0.58491334,
           0.06483191, 0.14861999, 0.1160014 , 0.18999026, 0.79386072,
           0.51594792, 0.24436546, 0.02765402, 0.50524883, 0.6935081 ,
           0.13000099, 0.20408408, 0.29929982, 0.08725797, 0.43145825,
           0.00835089, 1.02686889, 0.24924661, 0.87964541, 0.82278191,
           0.46730316, 0.73814915, 0.60058159, 0.369406  , 1.08246963,
           0.02952678, 0.36396157, 0.35693096, 1.12103547, 0.54215221,
           0.97265921, 0.17364534, 0.06984022, 0.06925087, 0.47642799,
           0.69248994, 0.51326343, 0.87906056, 0.3490113 , 0.13886565,
           0.30091549, 0.09881661, 0.17431435, 0.74572122, 0.46291655,
           0.74908726, 0.89491156, 0.13408916, 0.27173262, 0.13311964,
           0.21755445, 0.06566908, 0.29163963, 1.16599962, 0.13661129,
           0.82759518, 0.81013067, 0.94983091, 0.00934428, 0.23333567,
           0.26286474, 0.49855066, 1.17127249, 0.05338793, 0.29896025,
           0.07205129, 0.4629752 , 0.13235139, 1.09848297, 0.94398225,
           0.5429865 , 0.35984959, 0.07998364, 0.15724836, 0.10757797,
           0.45869794, 0.74053653, 0.78113531, 0.34060619, 0.89337262,
           0.20847627, 0.03314023, 0.26156332, 1.01184533, 0.08998926,
           0.35367888, 0.03867529, 0.16215214, 0.80779789, 0.50219615,
           0.08856524, 0.48032616, 0.27481036, 0.65464762, 0.79142579,
           0.67038365, 0.02312989, 0.40085516, 0.84982852, 0.74566367,
           0.35323906, 0.50460239, 0.80890933, 1.0777878 , 0.12627917,
           0.48467441, 0.09014233, 1.31501298, 0.76641368, 0.63056123,
           0.18174984, 0.49842293, 0.04843688, 1.0505552 , 1.04310707,
           0.4148771 , 0.7593948 , 0.63519805, 0.31414756, 0.57514404,
           0.71093711, 0.52704536, 0.85215271, 0.03519143, 0.36809586,
           0.87337654, 0.57508735, 0.38777156, 0.21044272, 0.18516092,
           0.05803669, 1.08864387, 0.09086297, 1.0984822 , 0.71240278,
           0.24269957, 0.06502214, 0.03890302, 0.97796292, 0.28361954,
           0.37783995, 0.16500465, 1.01349737, 0.32812573, 0.42917307,
           0.02548172, 0.03930606, 0.84482069, 0.8923749 , 0.91128877,
           0.53667153, 0.99538715, 0.50488459, 0.23113767, 0.36012515,
           0.74962248, 0.27267497, 1.44683603, 0.32624342, 0.31524494,
           0.45804708, 0.02213566, 1.30414985, 0.17154553, 0.67180095,
           0.02806665, 0.14903139, 0.83346665, 0.8681289 , 0.24386243,
           0.68122353, 0.08073748, 0.23853112, 0.76518913, 0.51630283,
           0.65258725, 0.34882787, 0.04810222, 0.34657895, 0.8192064 ,
           1.17448336, 1.2874989 , 0.85768771, 0.44698702, 0.67818909,
           0.23489476, 0.06869732, 0.71029264, 0.81243641, 0.10465329,
           0.71037603, 0.05625395, 0.12497713, 0.7795859 , 0.07495311,
           0.42255243, 0.30814792, 0.56180263, 0.33303272, 0.12241521,
           0.10618592, 0.77792367, 0.59509094, 0.83605609, 0.47931771,
           0.41161208, 1.21413011, 0.45790061, 0.14539074, 0.17349858,
           0.21002761, 0.55993419, 0.3759981 , 0.60551632, 0.64190101,
           0.48749714, 0.90991087, 1.2366127 , 0.46124581, 0.58852971,
           0.28674449, 0.47861005, 0.25055464, 0.11924704, 0.30346557,
           0.2715203 , 0.17554211, 1.14781942, 0.97584887, 0.39452265,
           0.61778948, 0.06868134, 1.49479402, 0.63707815, 0.15315922,
           0.35717641, 0.02420449, 0.20427758, 0.39667308, 0.39397098,
           0.26996894, 0.53016785, 0.04977743, 0.95317779, 0.07167683,
           0.14914845, 0.63094865, 0.73907552, 0.58072728, 0.96018384,
           0.24792596, 1.06118362, 0.43217626, 0.43325629, 0.99777217,
           0.1365105 , 0.3761197 , 0.10089525, 0.83401539, 0.22394896,
           0.85722827, 0.58451286, 0.65122767, 0.66032956, 0.5997496 ,
           0.41160271, 0.7240744 , 0.2724793 , 0.45630187, 0.14466028])




```python
sqDistances0 = sqDiffMat.sum(axis=0)
sqDistances0
```




    array([ 91.39170493,  37.99068833, 300.30061966])




```python
distances = sqDistances**0.5
```


```python
sortedDistIndicies = distances.argsort()
sortedDistIndicies
```




    array([493, 145, 399, 645, 252, 688,  86, 596, 534, 523, 271,  94, 791,
           414, 726, 384, 551, 866, 775, 565, 200, 637, 795, 655,  89,  75,
           711, 753, 100, 716, 767, 776, 558, 324, 258, 136, 472, 807, 742,
           872,  33, 378, 478,  85, 424, 420, 693, 224, 821, 229, 500,  62,
           760, 154, 594, 165, 590, 630, 766, 681, 575, 403, 415, 550, 861,
           816, 663, 662, 454, 620,  36, 874, 695,  18, 574, 540, 188, 824,
             7,  44, 226, 118, 452, 702,   1, 801, 105, 436, 355, 206, 192,
           643, 720, 115, 367, 714, 736, 442, 762, 395, 207, 553, 585,  25,
           479, 347, 671, 610, 527, 887, 589, 515, 520, 101, 189, 819, 830,
           704,  10, 532,  34, 212, 147, 168,  37, 632,  21, 202, 561, 853,
           624, 273, 435, 322, 627, 829, 583, 595, 822, 508, 440, 528, 734,
           588, 498,  82, 548, 640,  90, 269,  81, 697, 555, 679, 117, 604,
           677, 577, 241, 885, 684, 607, 293,  63, 669, 514, 166,   3, 468,
           141, 287, 360, 625, 321, 156, 303, 899, 351, 838, 341, 184, 631,
           295, 796, 875, 543, 193, 364, 253, 864, 563, 434, 410, 703,  88,
           379, 521,  32, 346, 443, 107, 717, 233, 476, 469, 771, 112,  77,
            43, 131, 530, 460, 284,  45, 793, 573, 839, 661, 672, 856,  52,
           257,  20,  53, 310, 470, 740, 484, 533, 458, 759,  50, 102,  27,
            84, 369, 330, 633, 239, 306, 328,  26, 305,  91, 617, 611, 474,
            15, 314, 153, 349, 592, 185, 641, 867,  74, 183, 710,  49, 840,
           758, 311, 542, 218, 315, 416, 680, 464, 566, 417,  68, 339, 889,
           352, 556, 453, 441, 619, 170, 196, 783, 570,  46, 204, 167, 459,
           357, 689, 815, 106, 621, 802, 765, 350, 336, 799, 636, 429, 880,
           580, 647, 390, 262,  73, 852, 178,  11, 628, 623, 169, 393, 386,
           208, 160, 292, 450, 712, 690, 447,  80, 870, 855, 678, 897, 786,
           722, 421, 172, 320, 451, 333, 343, 398, 190, 769, 221, 850, 486,
            67, 104, 144, 682,  60, 301, 694, 642, 234, 247, 312, 557, 670,
           854, 419, 418, 826, 299, 127, 485, 748, 456, 789, 505, 175, 584,
           483, 788, 773, 529, 261, 149, 213, 277, 828, 537, 294, 317,  93,
           370, 176, 449, 708, 808,  92, 806, 668,  95, 223, 601, 730, 715,
           308,  55,  41, 571, 657, 865, 304, 701, 784, 603, 656, 290, 754,
           653, 199, 519, 842, 886, 547, 391, 770, 124, 496, 374,  54,  12,
           509, 587, 757, 535, 445, 382, 526, 608, 869, 859, 373, 438, 868,
           516, 368, 727, 222,  78, 220, 278,  69, 895, 835, 745, 412,  13,
           300, 276, 255, 466, 181, 591, 825, 110, 774, 644, 882, 883, 209,
           148, 285, 376, 359, 329,  71,  76, 578, 325, 143, 401, 813, 180,
             5, 400, 274, 228,  61, 898, 186, 837, 790, 705, 488, 848, 674,
           696, 586, 225, 618, 327, 650, 201,  30, 195, 363, 323, 205, 502,
           337, 606,  57, 562, 616, 203, 402,  39, 664, 353, 851, 834, 721,
           433, 230, 735, 525, 356, 279, 845, 446, 268, 155, 266, 318, 741,
           691, 227,  40, 719, 335, 731, 782, 638, 198, 216, 448,  42, 666,
           372, 635, 804, 211, 371, 194, 348, 559, 331, 510, 751, 871,   4,
           462, 427,  35, 345, 780, 388, 130, 538, 549, 659, 700, 235, 137,
           531, 396, 841, 827, 288, 210, 512,  31, 164, 132, 756, 749,  19,
           544, 114, 511, 878, 891, 629, 265, 413, 385, 849, 219, 576, 272,
           423, 177, 832, 245, 197, 894, 652, 108, 477, 597,  16, 383, 354,
           843, 426, 134, 246, 342, 361, 432,  72, 187, 860, 326, 251, 567,
           489, 283, 739, 375, 876, 140, 747,  99, 863, 394, 844, 215, 560,
           366, 248, 892, 805, 723, 518, 581, 893, 163,  83, 598, 494, 725,
           794, 243, 814, 800,  87, 113,  79, 545, 404, 302, 665, 639, 157,
           296, 129, 405, 334,   8, 568, 817, 820, 750,  51, 764,  58, 238,
           173, 517,  47, 171, 142, 896, 444, 270,  65, 455, 344, 651, 501,
           877, 706, 490, 729, 602, 673, 675, 785, 275, 622, 430, 358, 267,
           746, 309, 803, 738, 119, 240, 522, 480, 569, 316, 831, 471, 823,
             2,  17, 707, 133, 504, 724, 634, 159,   6, 264, 513, 409, 475,
           139, 718, 732,  98, 686, 818, 362, 389, 809, 649, 319, 572, 380,
           126, 685, 615, 381, 135,  96, 397, 249, 797, 888, 609, 467, 833,
           120, 777, 286, 392, 728, 332, 546, 752, 411, 890, 812, 612, 161,
           425, 162, 482, 481, 122, 524, 798, 613, 289, 439, 755, 667, 648,
             0, 138, 539, 778, 709, 250, 407, 676, 552,  28, 125, 150, 263,
            56, 463, 461, 846, 779, 506, 499, 259, 281, 307, 217, 491, 495,
           174, 541, 699, 536, 457, 687, 152, 465, 873, 103, 232, 428, 377,
           182, 879, 406, 600, 151,   9, 660,  48, 431,  29, 858, 768, 605,
           340,  22, 123, 781, 282, 579, 109, 884,  97,  70, 365, 387, 713,
           564, 772, 313,  24,  23, 121, 582, 237, 646, 111, 191, 497, 503,
           422,  64,  66, 744, 116, 554, 244, 492, 743, 881, 437, 473, 128,
           599, 593, 733, 487, 654, 761, 254, 338,  14, 763, 698, 179, 297,
           231, 658, 291, 857,  38, 683, 692, 810, 236, 158, 836, 626, 847,
           242,  59, 614, 280, 507, 146, 298, 811, 408, 256, 792, 737, 214,
           787, 862, 260])




```python
voteILabel = h[sortedDistIndicies[1]]
voteILabel
```




    3




```python
classCount={}
classCount[voteILabel] = classCount.get(voteILabel,0)+1
classCount
```




    {3: 1}




```python
sortedClassCount = sorted(classCount.items(),key = operator.itemgetter(1),reverse=True)
sortedClassCount
```




    [(3, 1)]




```python
def classify0(inX,dataSet,labels,k):
    dataSetSize = dataSet.shape[0]
    #取出行数
    diffMat = tile(inX,(dataSetSize,1)) - dataSet
    # 将inX转化成dateSet形式
    sqDiffMat = diffMat**2
    sqDistances = sqDiffMat.sum(axis=1)
    #axis=1表示按行相加 , axis=0表示按列相加
    distances = sqDistances**0.5
    sortedDistIndicies = distances.argsort()
    #将distance数组的indx排序
    classCount={}
    for i in range (k):
        voteILabel = labels[sortedDistIndicies[i]]
        classCount[voteILabel] = classCount.get(voteILabel,0)+1
        #这里还用到了dict.get(key, default=None)函数，key就是dict中的键voteIlabel，如果不存在则返回一个0并存入dict，如果存在则读取当前值并+1
        sortedClassCount = sorted(classCount.items(),
                              key = operator.itemgetter(1),reverse=True)
        # sorted()函数sorted(iterable, cmp=None, key=None, reverse=False)，iteritems()将dict分解为元组列表，operator.itemgetter(1)表示按照第二个元素的次序对元组进行排序，注意sort()的区别，可参考numpy.sort；
    return sortedClassCount[0][0]
```


```python

```
